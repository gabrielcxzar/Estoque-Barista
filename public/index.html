<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barista Pro | Gest√£o</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>

    <!-- SIDEBAR -->
    <nav class="sidebar">
        <div class="logo"><i data-lucide="coffee"></i> Barista Pro</div>
        
        <div class="nav-label">Geral</div>
        <button class="menu-btn active" onclick="showScreen('dashboard')"><i data-lucide="layout-dashboard"></i> Dashboard</button>
        <button class="menu-btn" onclick="showScreen('cadastros')"><i data-lucide="package"></i> Cadastros</button>
        
        <div class="nav-label">Opera√ß√£o</div>
        <button class="menu-btn" onclick="showScreen('movimentacao')"><i data-lucide="arrow-left-right"></i> Movimenta√ß√£o</button>
        
        <div class="nav-label">An√°lise</div>
        <button class="menu-btn" onclick="showScreen('relatorios')"><i data-lucide="bar-chart-2"></i> Relat√≥rios</button>
    </nav>

    <!-- MAIN -->
    <main class="main-content">
        
        <!-- DASHBOARD -->
        <section id="dashboard" class="screen active">
            <header>
                <div><h1>Dashboard</h1><div class="subtitle">Resumo do dia.</div></div>
                <div id="dataAtual" style="color: var(--text-muted); font-size: 0.9rem;"></div>
            </header>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-label">Valor em Estoque</div><div class="stat-value" id="dashValorTotal">R$ 0,00</div></div>
                <div class="stat-card"><div class="stat-label">Itens Cr√≠ticos</div><div class="stat-value" id="dashItensCriticos">0</div></div>
                <div class="stat-card"><div class="stat-label">Vencendo (7 dias)</div><div class="stat-value" id="dashVencendo">0</div></div>
            </div>
            <h3 style="margin-bottom: 16px;">Atividades Recentes</h3>
            <div class="table-container">
                <table><thead><tr><th>Data</th><th>Produto</th><th>Tipo</th><th>Qtd</th></tr></thead><tbody id="dashUltimasAtividades"></tbody></table>
            </div>
        </section>

        <!-- CADASTROS (Produtos e Categorias) -->
        <section id="cadastros" class="screen">
            <header>
                <div><h1>Cadastros</h1><div class="subtitle">Gerencie produtos e categorias.</div></div>
                <button class="btn btn-primary" onclick="abrirModalCadastro()"><i data-lucide="plus"></i> Novo Item</button>
            </header>
            <div class="grid-cadastros">
                <!-- Coluna Esquerda: Categorias -->
                <div class="stat-card" style="height: fit-content;">
                    <h3 style="margin-bottom: 15px;">Categorias</h3>
                    <div style="display: flex; gap: 8px; margin-bottom: 15px;">
                        <input id="novaCategoria" placeholder="Nova Categoria..." style="flex:1">
                        <button class="btn btn-secondary" onclick="adicionarCategoria()"><i data-lucide="plus"></i></button>
                    </div>
                    <ul id="listaCategorias" class="cat-list"></ul>
                </div>
                <!-- Coluna Direita: Lista de Produtos -->
                <div class="table-container">
                    <table>
                        <thead><tr><th>Produto</th><th>Categoria</th><th style="text-align:right">A√ß√µes</th></tr></thead>
                        <tbody id="tabelaCadastros"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- MOVIMENTA√á√ÉO (PDV) -->
        <section id="movimentacao" class="screen">
            <header><div><h1>Movimenta√ß√£o</h1><div class="subtitle">Entrada e Sa√≠da de Estoque.</div></div></header>
            <div class="mode-toggle">
                <button class="mode-btn active-saida" id="btnModoSaida" onclick="setModo('SAIDA')">SA√çDA</button>
                <button class="mode-btn" id="btnModoEntrada" onclick="setModo('ENTRADA')">ENTRADA</button>
            </div>
            <div class="pos-layout">
                <div style="display: flex; flex-direction: column; gap: 16px;">
                    <div class="search-wrapper">
                        <i data-lucide="search"></i>
                        <input type="text" id="buscaMovimento" class="search-input" placeholder="Buscar item..." onkeyup="renderizarTelaMovimento(this.value)">
                    </div>
                    <div id="listaProdutosMovimento" class="pos-products"></div>
                </div>
                <div class="pos-cart">
                    <div class="cart-header"><h3 id="tituloCarrinho">Itens para Sa√≠da</h3></div>
                    <div class="cart-items" id="carrinhoLista"></div>
                    <div class="cart-footer"><button class="btn btn-primary" id="btnFinalizarMovimento" style="width: 100%;" onclick="finalizarMovimentacao()">Confirmar</button></div>
                </div>
            </div>
        </section>

        <!-- RELAT√ìRIOS -->
        <section id="relatorios" class="screen">
            <header><h1>Relat√≥rios</h1></header>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 style="color:var(--danger-text)">üö® Vencidos / Perto</h3>
                    <table style="margin-top:10px; font-size:0.9rem">
                        <thead><tr><th>Item</th><th>Data</th><th>Qtd</th></tr></thead>
                        <tbody id="relVencimentos"></tbody>
                    </table>
                </div>
                <div class="stat-card">
                    <h3 style="color:var(--warning-text)">‚ö†Ô∏è Estoque Cr√≠tico</h3>
                    <table style="margin-top:10px; font-size:0.9rem">
                        <thead><tr><th>Item</th><th>Atual</th><th>Ref</th></tr></thead>
                        <tbody id="relCriticos"></tbody>
                    </table>
                </div>
                <div class="stat-card">
                    <h3 style="color:var(--text-main)">üî• Mais Sa√≠dos (Top 10)</h3>
                    <table style="margin-top:10px; font-size:0.9rem">
                        <thead><tr><th>Item</th><th>Total Sa√≠da</th></tr></thead>
                        <tbody id="relSaidos"></tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>
    
    <div id="toast-container"></div>

    <!-- MODAL FORM -->
    <div id="modalForm" class="modal-overlay">
        <div class="modal-content">
            <h2 id="modalTitle" style="margin-bottom: 24px;">Novo Item</h2>
            <form id="formProduto">
                <input type="hidden" id="id_produto">
                <div class="form-row">
                    <div class="form-group"><label>Nome</label><input id="nome" required></div>
                    <div class="form-group"><label>Categoria</label><select id="categoria"></select></div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Qtd Atual</label><input type="number" id="quantidade" step="0.01" required></div>
                    <div class="form-group"><label>Unidade</label>
                        <select id="unidade"><option value="un">un</option><option value="kg">kg</option><option value="L">L</option><option value="ml">ml</option></select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group"><label>M√≠nimo</label><input type="number" id="estoque_minimo" step="0.01" required></div>
                    <div class="form-group"><label>Custo (R$)</label><input type="number" id="preco" step="0.01"></div>
                </div>
                <div class="form-group"><label>Validade</label><input type="date" id="data_validade"></div>
                <p id="avisoEdicao" style="font-size: 0.8rem; color: #78716C; margin-bottom: 15px; display: none;">* Use a tela de Movimenta√ß√£o para alterar estoque.</p>
                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="button" class="btn btn-secondary" style="flex:1" onclick="fecharModais()">Cancelar</button>
                    <button type="submit" class="btn btn-primary" style="flex:1">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>